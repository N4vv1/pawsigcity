<!DOCTYPE html>
<html>
<head>
  <title>HelpPawl</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../homepage/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="../../homepage/images/Logo.jpg">
  <style>
    * {
      box-sizing: border-box;
    }

    :root {
      --white-color: #fff;
      --dark-color: #252525;
      --primary-color: #A8E6CF;
      --secondary-color: #FFE29D;
      --accent-color: #FFD1DC;
      --medium-gray-color: #e0e0e0;
      --light-gray: #f5f5f5;
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.12);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8f5e9 100%);
      color: var(--dark-color);
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* Chat Container - Full Window */
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: var(--white-color);
      overflow: hidden;
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
      margin-top: 150px;
    }

    /* Chat Header */
    .chat-header {
      background: linear-gradient(135deg, var(--primary-color) 0%, #8CD9B3 100%);
      padding: 20px 30px;
      color: var(--dark-color);
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: var(--shadow-md);
      position: relative;
      flex-shrink: 0;
    }

    .chat-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));
    }

    .chat-header i.fa-robot {
      font-size: 28px;
      color: var(--dark-color);
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-5px); }
    }

    .chat-header h3 {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      color: var(--dark-color);
      letter-spacing: -0.3px;
    }

    .chat-status {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--dark-color);
      font-weight: 500;
      background: rgba(255, 255, 255, 0.5);
      padding: 6px 12px;
      border-radius: 20px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      background: #10b981;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
      50% { opacity: 0.8; box-shadow: 0 0 0 4px rgba(16, 185, 129, 0); }
    }

    /* Chat Messages Area */
    #chat {
      flex: 1;
      padding: 24px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 16px;
      background: linear-gradient(to bottom, #f8f9fa 0%, #ffffff 100%);
      position: relative;
    }

    /* Decorative background pattern */
    #chat::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(168, 230, 207, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 226, 157, 0.1) 0%, transparent 50%);
      pointer-events: none;
    }

    .message-wrapper {
      display: flex;
      align-items: flex-end;
      gap: 10px;
      animation: messageSlide 0.3s ease-out;
      position: relative;
      z-index: 1;
    }

    @keyframes messageSlide {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .user-msg,
    .bot-msg {
      padding: 14px 18px;
      border-radius: 18px;
      max-width: 70%;
      font-size: 15px;
      line-height: 1.5;
      word-wrap: break-word;
      position: relative;
      font-weight: 400;
    }

    .user-msg {
      align-self: flex-end;
      background: linear-gradient(135deg, var(--dark-color) 0%, #3a3a3a 100%);
      color: white;
      border-bottom-right-radius: 4px;
      box-shadow: var(--shadow-md);
    }

    .bot-msg {
      align-self: flex-start;
      background: var(--white-color);
      color: var(--dark-color);
      border: 2px solid var(--primary-color);
      border-bottom-left-radius: 4px;
      box-shadow: var(--shadow-sm);
    }

    .bot-avatar, .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      flex-shrink: 0;
      border: 2px solid var(--white-color);
      box-shadow: var(--shadow-md);
    }

    .bot-avatar {
      background: linear-gradient(135deg, var(--primary-color) 0%, #8CD9B3 100%);
      color: var(--dark-color);
    }

    .user-avatar {
      background: linear-gradient(135deg, var(--dark-color) 0%, #3a3a3a 100%);
      color: white;
    }

    /* Quick Questions Modal */
    .quick-questions-modal {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: var(--white-color);
      border-radius: 20px;
      box-shadow: var(--shadow-lg);
      padding: 24px;
      max-width: 600px;
      width: 90%;
      max-height: 70vh;
      overflow-y: auto;
      z-index: 1000;
      display: none;
      border: 2px solid var(--primary-color);
    }

    .quick-questions-modal.active {
      display: block;
      animation: modalSlideUp 0.3s ease-out;
    }

    @keyframes modalSlideUp {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--light-gray);
    }

    .modal-header h4 {
      margin: 0;
      font-size: 18px;
      font-weight: 700;
      color: var(--dark-color);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .modal-header h4 i {
      color: var(--primary-color);
      font-size: 20px;
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      color: #6b7280;
      cursor: pointer;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    .close-modal:hover {
      background: var(--light-gray);
      color: var(--dark-color);
    }

    .question-category {
      margin-bottom: 20px;
    }

    .category-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--dark-color);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .category-title i {
      color: var(--primary-color);
      font-size: 14px;
    }

    .question-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .question-btn {
      background: linear-gradient(135deg, var(--light-gray) 0%, #e8e8e8 100%);
      color: var(--dark-color);
      font-size: 13px;
      font-weight: 500;
      padding: 10px 16px;
      border-radius: 20px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .question-btn:hover {
      background: linear-gradient(135deg, var(--primary-color) 0%, #8CD9B3 100%);
      border-color: var(--primary-color);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .question-btn:active {
      transform: translateY(0);
    }

    /* Input Section */
    .input-section {
      padding: 20px 24px;
      background: var(--white-color);
      border-top: 2px solid var(--light-gray);
      flex-shrink: 0;
      box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.05);
    }

    .input-area {
      display: flex;
      gap: 12px;
      align-items: flex-end;
      max-width: 1200px;
      margin: 0 auto;
      position: relative;
    }

    .quick-btn {
      padding: 14px;
      font-size: 18px;
      background: linear-gradient(135deg, var(--primary-color) 0%, #8CD9B3 100%);
      color: var(--dark-color);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 52px;
      height: 52px;
      box-shadow: var(--shadow-md);
      flex-shrink: 0;
      position: relative;
    }

    .quick-btn:hover {
      transform: scale(1.05);
      box-shadow: var(--shadow-lg);
    }

    .quick-btn:active {
      transform: scale(0.95);
    }

    .quick-btn.active {
      background: linear-gradient(135deg, var(--secondary-color) 0%, #FFD699 100%);
    }

    #userInput {
      flex-grow: 1;
      padding: 14px 20px;
      font-size: 15px;
      border: 2px solid var(--medium-gray-color);
      border-radius: 24px;
      outline: none;
      background: var(--white-color);
      transition: all 0.2s ease;
      font-family: inherit;
      resize: none;
      min-height: 24px;
      max-height: 120px;
    }

    #userInput:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(168, 230, 207, 0.2);
    }

    .send-btn {
      padding: 14px;
      font-size: 18px;
      background: linear-gradient(135deg, var(--dark-color) 0%, #3a3a3a 100%);
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 52px;
      height: 52px;
      box-shadow: var(--shadow-md);
      flex-shrink: 0;
    }

    .send-btn:hover {
      transform: scale(1.05);
      box-shadow: var(--shadow-lg);
    }

    .send-btn:active {
      transform: scale(0.95);
    }

    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: scale(1);
    }

    /* Typing Indicator */
    .typing-indicator {
      display: none;
      align-items: center;
      gap: 10px;
      padding: 14px 18px;
      background: var(--white-color);
      border: 2px solid var(--primary-color);
      border-radius: 18px;
      border-bottom-left-radius: 4px;
      max-width: 70%;
      align-self: flex-start;
      box-shadow: var(--shadow-sm);
    }

    .typing-dots {
      display: flex;
      gap: 4px;
    }

    .typing-dots span {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--primary-color);
      animation: typing 1.4s infinite ease-in-out;
    }

    .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
    .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

    @keyframes typing {
      0%, 80%, 100% {
        transform: scale(0);
        opacity: 0.5;
      }
      40% {
        transform: scale(1);
        opacity: 1;
      }
    }

    

    /* Welcome Card */
    .welcome-card {
      background: linear-gradient(135deg, var(--primary-color) 0%, #8CD9B3 100%);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-md);
      border: 2px solid rgba(255, 255, 255, 0.5);
      position: relative;
      overflow: hidden;
    }

    .welcome-card::before {
      content: '🐾';
      position: absolute;
      font-size: 80px;
      right: -10px;
      bottom: -10px;
      opacity: 0.2;
    }

    .welcome-card h3 {
      margin: 0 0 12px 0;
      font-size: 20px;
      font-weight: 700;
      color: var(--dark-color);
    }

    .welcome-card p {
      margin: 0;
      font-size: 14px;
      color: var(--dark-color);
      line-height: 1.6;
    }

    /* Scrollbar */
    #chat::-webkit-scrollbar,
    .quick-questions-modal::-webkit-scrollbar {
      width: 8px;
    }

    #chat::-webkit-scrollbar-track,
    .quick-questions-modal::-webkit-scrollbar-track {
      background: transparent;
    }

    #chat::-webkit-scrollbar-thumb,
    .quick-questions-modal::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 4px;
    }

    #chat::-webkit-scrollbar-thumb:hover,
    .quick-questions-modal::-webkit-scrollbar-thumb:hover {
      background: #8CD9B3;
    }

    /* Overlay */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: 999;
      display: none;
    }

    .modal-overlay.active {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .chat-header {
        padding: 16px 20px;
      }

      .chat-header h3 {
        font-size: 16px;
      }

      #chat {
        padding: 16px;
        gap: 12px;
      }

      .user-msg, .bot-msg {
        max-width: 80%;
        font-size: 14px;
        padding: 12px 16px;
      }

      .bot-avatar, .user-avatar {
        width: 32px;
        height: 32px;
        font-size: 14px;
      }

      .input-section {
        padding: 16px;
      }

      #userInput {
        font-size: 14px;
        padding: 12px 16px;
      }

      .send-btn, .quick-btn {
        width: 48px;
        height: 48px;
        font-size: 16px;
      }

      .quick-questions-modal {
        width: 95%;
        padding: 20px;
        bottom: 90px;
      }

      .welcome-card {
        padding: 20px;
      }

      .welcome-card h3 {
        font-size: 18px;
      }
    }

    @media (max-width: 480px) {
      .chat-header {
        padding: 12px 16px;
      }

      .chat-status {
        font-size: 11px;
        padding: 4px 10px;
      }

      .status-dot {
        width: 6px;
        height: 6px;
      }

      #chat {
        padding: 12px;
      }

      .user-msg, .bot-msg {
        max-width: 85%;
        font-size: 13px;
        padding: 10px 14px;
      }

      .bot-avatar, .user-avatar {
        width: 28px;
        height: 28px;
        font-size: 12px;
      }

      .send-btn, .quick-btn {
        width: 44px;
        height: 44px;
      }

      .question-btn {
        font-size: 12px;
        padding: 8px 14px;
      }
    }
  </style>
</head>

<body>
  <header>
    <nav class="navbar section-content">
      <a href="#" class="navbar-logo">
        <img src="../../homepage/images/pawsig.png" alt="Logo" class="icon" />
      </a>
      <ul class="nav-menu">
        <li class="nav-item"><a href="../../homepage/main.php" class="nav-link">Home</a></li>
        <li class="nav-item"><a href="../../homepage/main.php" class="nav-link">About</a></li>
        <li class="nav-item"><a href="../../homepage/main.php" class="nav-link">Services</a></li>
        <li class="nav-item"><a href="../../homepage/main.php" class="nav-link">Gallery</a></li>
        <li class="nav-item"><a href="../../homepage/main.php" class="nav-link">Contact</a></li>
        <li class="nav-item dropdown">
          <a href="#" class="nav-link profile-icon active">
            <i class="fas fa-user-circle"></i>
          </a>
          <ul class="dropdown-menu">
            <li><a href="../../pets/pet-profile.php">Pet Profiles</a></li>
            <li><a href="../../pets/add-pet.php">Add Pet</a></li>
            <li><a href="./../../appointment/book-appointment.php">Book</a></li>
            <li><a href="../../homepage/appointments.php">Appointments</a></li>
            <li><a href="../../Purrfect-paws/ai/chatbot/index.html">Help Center</a></li>
            <li><a href="../../homepage/logout/logout.php">Logout</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </header>

  <!-- Modal Overlay -->
  <div class="modal-overlay" id="modalOverlay" onclick="toggleQuickQuestions()"></div>

  <!-- Quick Questions Modal -->
  <div class="quick-questions-modal" id="quickQuestionsModal">
    <div class="modal-header">
      <h4><i class="fas fa-magic"></i>Quick Questions</h4>
      <button class="close-modal" onclick="toggleQuickQuestions()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="question-category">
      <div class="category-title">
        <i class="fas fa-comments"></i>
        General
      </div>
      <div class="question-buttons">
        <button class="question-btn" onclick="sendSuggested('hi')">Hi</button>
        <button class="question-btn" onclick="sendSuggested('hello')">Hello</button>
        <button class="question-btn" onclick="sendSuggested('what is your name')">What is your name?</button>
        <button class="question-btn" onclick="sendSuggested('thank you')">Thank you</button>
        <button class="question-btn" onclick="sendSuggested('bye')">Goodbye</button>
      </div>
    </div>

    <div class="question-category">
      <div class="category-title">
        <i class="fas fa-map-marker-alt"></i>
        Location & Contact
      </div>
      <div class="question-buttons">
        <button class="question-btn" onclick="sendSuggested('where are you located')">Where are you located?</button>
        <button class="question-btn" onclick="sendSuggested('what are your contact')">Contact info?</button>
        <button class="question-btn" onclick="sendSuggested('when are you open')">When are you open?</button>
      </div>
    </div>

    <div class="question-category">
      <div class="category-title">
        <i class="fas fa-calendar-alt"></i>
        Booking & Appointments
      </div>
      <div class="question-buttons">
        <button class="question-btn" onclick="sendSuggested('how can i book an appointment')">How to book?</button>
        <button class="question-btn" onclick="sendSuggested('do you accept walk-ins')">Walk-ins accepted?</button>
      </div>
    </div>

    <div class="question-category">
      <div class="category-title">
        <i class="fas fa-cut"></i>
        Services & Pricing
      </div>
      <div class="question-buttons">
        <button class="question-btn" onclick="sendSuggested('what services do you offer')">All services?</button>
        <button class="question-btn" onclick="sendSuggested('do you offer grooming services')">Grooming services?</button>
        <button class="question-btn" onclick="sendSuggested('how much is grooming')">Grooming cost?</button>
      </div>
    </div>

    <div class="question-category">
      <div class="category-title">
        <i class="fas fa-credit-card"></i>
        Payment
      </div>
      <div class="question-buttons">
        <button class="question-btn" onclick="sendSuggested('what payment methods do you accept')">Payment methods?</button>
      </div>
    </div>
  </div>

  <div class="chat-container">
    <div class="chat-header">
      <i class="fas fa-robot"></i>
      <h3>Pawsig Assistant</h3>
      <div class="chat-status">
        <div class="status-dot"></div>
        <span>Online</span>
      </div>
    </div>
    
    <div id="chat">
      <!-- Welcome Card -->
      <div class="welcome-card">
        <h3> Welcome to PAWSigCity</h3>
        <p>I'm HelpPAWL, your friendly assistant. I'm here to help you with any questions about our services, booking appointments, or general information. Feel free to ask me anything or use the quick questions button below!</p>
      </div>
      
      <div class="typing-indicator" id="typingIndicator">
        <div class="bot-avatar">
          <i class="fas fa-paw"></i>
        </div>
        <div style="display: flex; flex-direction: column; gap: 4px;">
          <div style="font-size: 12px; color: #9ca3af; font-weight: 500;">Assistant is typing...</div>
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <div class="input-section">
      <div class="input-area">
        <button class="quick-btn" id="quickBtn" onclick="toggleQuickQuestions()" title="Quick Questions">
          <i class="fas fa-lightbulb"></i>
        </button>
        <textarea id="userInput" placeholder="Type your message..." rows="1"></textarea>
        <button class="send-btn" id="sendBtn" onclick="sendMessage()">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>

  <script>
    // Hardcoded Q&A Database
    const qaDatabase = {
      "hi": "Hello there! 👋",
      "hello": "Hi! How can I assist you today? 😊",
      "where are you located": "Hello! Purrfect Paws is located at 324 Dr. Sixto Antonio Avenue Caniogan Pasig City. ",
      "what are your contact": "You can email us at purrfectpaws@gmail.com or reach us via call or text at 09123. ",
      "when are you open": "We're open daily from 9:00 AM to 8:00 PM Monday to Sunday. ",
      "what is your name": "Hi! I'm your friendly assistant at Help Pawl. ",
      "how can i book an appointment": "You can book an appointment online through our website or contact us directly via call or text. ",
      "do you offer grooming services": "Yes! We offer pet grooming services including Full Grooming, Bath and Dry, and Spa Bath. ",
      "how much is grooming": "Grooming prices start at ₱499 depending on the size and breed of your pet. 💰",
      "do you accept walk-ins": "We highly recommend appointments, but we do accept walk-ins when available. 🚶‍♂️",
      "what services do you offer": "We offer Full grooming, Bath and Dry, Spa Bath. ",
      "what payment methods do you accept": "We accept cash, GCash for walk-ins. ",
      "thank you": "You're welcome! Let me know if there's anything else I can help with. ",
      "bye": "Goodbye! Hope to see you and your pet soon!🐾"
    };

    // Function to find matching response
    function getResponse(userMessage) {
      const normalizedMessage = userMessage.toLowerCase().trim();
      
      // Check for exact match first
      if (qaDatabase[normalizedMessage]) {
        return qaDatabase[normalizedMessage];
      }
      
      // Check for partial matches
      for (const [question, answer] of Object.entries(qaDatabase)) {
        if (normalizedMessage.includes(question) || question.includes(normalizedMessage)) {
          return answer;
        }
      }
      
      // Default response for unrecognized questions
      return "I'm sorry, I didn't quite understand that. 🤔 You can try asking about our location, services, booking appointments, or use the quick questions button for common queries!";
    }

    // Auto-resize textarea
    const userInput = document.getElementById("userInput");
    userInput.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = Math.min(this.scrollHeight, 120) + 'px';
    });

    // Send message on Enter (but not Shift+Enter)
    userInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
        }
    });

    function toggleQuickQuestions() {
      const modal = document.getElementById("quickQuestionsModal");
      const overlay = document.getElementById("modalOverlay");
      const quickBtn = document.getElementById("quickBtn");
      
      modal.classList.toggle("active");
      overlay.classList.toggle("active");
      quickBtn.classList.toggle("active");
    }

    function showTypingIndicator() {
      const indicator = document.getElementById("typingIndicator");
      indicator.style.display = "flex";
      scrollToBottom();
    }

    function hideTypingIndicator() {
      const indicator = document.getElementById("typingIndicator");
      indicator.style.display = "none";
    }

    function scrollToBottom() {
      const chat = document.getElementById("chat");
      setTimeout(() => {
        chat.scrollTop = chat.scrollHeight;
      }, 100);
    }

    function sendMessage(message = null) {
      const input = document.getElementById("userInput");
      const chat = document.getElementById("chat");
      const sendBtn = document.getElementById("sendBtn");
      const userMessage = message || input.value.trim();
      
      if (!userMessage) return;

      // Close modal if open
      const modal = document.getElementById("quickQuestionsModal");
      const overlay = document.getElementById("modalOverlay");
      const quickBtn = document.getElementById("quickBtn");
      if (modal.classList.contains("active")) {
        modal.classList.remove("active");
        overlay.classList.remove("active");
        quickBtn.classList.remove("active");
      }

      // Disable send button
      sendBtn.disabled = true;

      // Add user message
      const userWrapper = document.createElement('div');
      userWrapper.className = 'message-wrapper';
      userWrapper.style.justifyContent = 'flex-end';
      userWrapper.innerHTML = `
        <div class="user-msg"><strong>You:</strong> ${escapeHtml(userMessage)}</div>
        <div class="user-avatar"><i class="fas fa-user"></i></div>
      `;
      chat.appendChild(userWrapper);
      
      input.value = "";
      input.style.height = 'auto';
      scrollToBottom();

      // Show typing indicator
      showTypingIndicator();

      // Get response from database
      const botResponse = getResponse(userMessage);

      // Simulate typing delay for more natural feel
      setTimeout(() => {
        hideTypingIndicator();
        const botWrapper = document.createElement('div');
        botWrapper.className = 'message-wrapper';
        botWrapper.innerHTML = `
          <div class="bot-avatar"><i class="fas fa-paw"></i></div>
          <div class="bot-msg"><strong>Assistant:</strong> ${botResponse}</div>
        `;
        chat.appendChild(botWrapper);
        scrollToBottom();
        sendBtn.disabled = false;
        input.focus();
      }, Math.random() * 800 + 600);
    }

    function sendSuggested(text) {
      sendMessage(text);
    }

    // Escape HTML to prevent XSS
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Focus input on load
    window.addEventListener('load', () => {
      userInput.focus();
      scrollToBottom();
    });

    // Close modal when clicking outside
    document.addEventListener('click', function(e) {
      const modal = document.getElementById("quickQuestionsModal");
      const quickBtn = document.getElementById("quickBtn");
      const overlay = document.getElementById("modalOverlay");
      
      if (!modal.contains(e.target) && !quickBtn.contains(e.target) && modal.classList.contains("active")) {
        modal.classList.remove("active");
        overlay.classList.remove("active");
        quickBtn.classList.remove("active");
      }
    });
  </script>
</body>
</html>